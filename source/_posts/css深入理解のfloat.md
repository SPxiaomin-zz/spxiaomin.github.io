---
title: css深入理解のfloat
date: 2017-02-12 08:36:25
categories: ['技术', '前端技术']
tags: ['css', 'float']
---

!!!未完成

先借用一下w3c的盒子模型图片，下文将会用到。

{% asset_img boxdim.png '盒子模型' %}

正文开始～

这些规则里面指的其他元素指的仅仅是与当前浮动在同一个块级格式化上下文的其他元素。

{% codepen SPxiaomin mWXaQB 0 result 265 %}

## float

浮动属性简介——

value: left | right | none | inherit；
initial: none;
Applies to: all, but 当元素 position 设置了 absolute or fixed 的时候，float's computed value is none；
<!-- TODO: specified value & computed value & used value & local value 区别插入学习——参考规范&css 权威指南 -->
inherited: none;
percentages: N/A；
computed value: as specified；

浮动盒子是一个 `block-level box`；

<!-- 学会用 js 获取元素的样式，然后通过 dom 操作显示 display 值，看看 jquery css 是获取的什么值 -->

浮动盒子旁边的内容会在左侧或是右侧流动，从浮动盒子的 `top margin edge` 开始(但是当存在 `clear` 的时候另说)。

{% codepen SPxiaomin NpbMvM 0 result 265 %}

一个浮动盒子必须被尽可能往高放。一个左浮动盒子必须被尽可能往左放，一个右浮动盒子必须被尽可能往右放。一个更高的位置优先于一个更左/右的位置。

## float & absolute

在元素被设置为 absolute 之后，浮动就失效了，`float` 属性的计算值为 `none`。

{% codepen SPxiaomin XMNqmG 0 result 265 %}

## float & containing block

> 首先补充一下和浮动相关的包含块(containing box)知识，float 的 containing box 是父 block 元素的 content-box。

<!-- TODO: 稍后再插入，相关的知识点对于我来说存在有难度 -->
<https://www.w3.org/TR/CSS2/visudet.html#containing-block-details>
<https://www.w3.org/TR/CSS2/visuren.html#block-boxes>

一个左浮动盒的 `left margin edge` 不能在其 `containing block` 的 `left edge` 之左。右浮动同样。

一个浮动盒子的 `top margin edge` 不能高于其 `containing block` 的 `top edge`。

{% codepen SPxiaomin pePpMV 0 result 265 %}

一个左浮动的盒子如果在其左侧有另外的左浮动盒子，那么这个左浮动盒子的 `right margin edge` 不可以在 `containing box's right edge` 之右。除非当前的左浮动盒子已经尽可能靠左了。对于右浮动盒子也是同样的。

{% codepen SPxiaomin xqpWQv 0 result 265 %}

## float & float

当前浮动盒子的 `top margin edge` 不可高于 任何位于源文档中当前元素之前的元素生成的浮动盒子的 `top margin edge`。(原文：The outer top of a floating box may not be higher than the outer top of any floated box generated by an element earlier in the source document.)

{% codepen SPxiaomin xqzRgb 0 result 265 %}

如果当前行没有足够的空间来容纳浮动盒子，那么浮动盒子会向下移动，直到空间合适或者没有浮动出现了。

{% codepen SPxiaomin QdXxPp 0 result 265 %}

### 同方向

如果在源文档中，有比当前左浮动盒更前的元素生成了左浮动盒，那么当前左浮动盒或者其 `left margin edge` 必须在更前的浮动盒的 `right margin edge` 的右边，或者当前左浮动盒的 `top margin edge` 在更前的浮动盒的 `bottom margin edge` 的下方。右浮动盒同理。

{% codepen SPxiaomin dvvObX 0 result 265 %}

### 不同方向

一个左浮动盒子的 `right margin edge` 不可以在与之相邻的右浮动盒子的 `left margin edge` 之右。右浮动盒子同理。

{% codepen SPxiaomin PpmEXG 0 result 265 %}

## float 与 block boxes

当前浮动盒子的 `top margin edge` 不可高于 任何位于源文档中当前元素之前的元素生成的 `block box` 的 `top margin edge`。

其实就是当前浮动盒子的 `top margin edge` 在 任何位于源文档中当前元素之前的元素生成的 `block box's bottom margin edge` 之下。

{% codepen SPxiaomin BWZMdR 0 result 265 %}

## float 与 line-box

当前浮动盒子的 `top margin edge` 不可高于 任何 位于源文档中当前元素之前的元素生成的 `box` 所在的 `line-box` 的 `top`。

其实就是当前浮动盒子与 `line-box(包含有源文档中当前浮动元素之前的元素生成的 box)` 有两种关系：

1. 当前浮动盒子的 `top margin edge` 与 `line box's top` 对齐；
2. 当前浮动盒子的 `top margin edge` 在 `line box` 之下，并且与 `line box's bottom` 对齐；

{% codepen SPxiaomin yMpKpj 0 result 265 %}

### 文字环绕效果

浮动最有趣的特性就是文字环绕效果(除非被 `clear` 属性禁止了)，文字会环绕在左浮动盒的右侧排列或者右浮动盒的左侧排列。

顺带讲解一下文字环绕效果相关的原理知识：因为浮动盒不在流内，在浮动盒子之前和之后创建的非定位(non-positioned) `块盒(block boxes)` 会照旧垂直排列，表现得就好像浮动不存在一样。但是在浮动盒子旁边的 `行盒(line box)` 会进行必要的缩短，为浮动盒子的 `margin box` 留出空间，进而就产生了文字环绕效果了。

{% codepen SPxiaomin ggyrgr 0 result 265 %}

> 注意是 `块盒(block boxes)` 而不是 `block-level box` (e.g. block img replaced element or table) 或者 `block container box`(inline-block)；

> {% codepen SPxiaomin EZBXNM 0 result 265 %}
<!-- TODO: 插入这些box的解释 -->

文字环绕效果中的 content reflow 情况——在一个行盒中，任何在浮动盒子之前(比如在左浮动的左边或者右浮动的右边)的内容，都会被移动到浮动盒子之后。

{% codepen SPxiaomin jydBwm 0 result 265 %}

但是在文字环绕效果中，也有一点需要注意的事情，当行盒被缩短到无法容纳任何内容的时候，那么行盒就会被向下移动，直到可以容纳内容或者不再有浮动出现为止。

{% codepen SPxiaomin ggNRVX 0 result 265 %}

还有一种比较少见的情况，那就是当浮动的 `outer height` 为0或者负值的时候，浮动盒子旁边的行盒就不会缩短，进而也就不会产生文字环绕效果了。

{% codepen SPxiaomin YNmwEx 0 result 265 %}

## float & bfc

在同一个bfc中，正常流(normal flow)中生成bfc的元素(比如说一个带有 overflow 属性值为非 visible的元素)的 `border box` 不能够与float元素的 `margin box` 有重叠。可以用这个效果来实现一侧定宽的自适应布局，可复用性非常好。

{% codepen SPxiaomin zNeNqK 0 result 265 %}

## float & margin collapse

浮动元素是不会和父元素发生 `margin collapse` 的，因为 `margin collapse` 的前提是在同一个bfc中的流内块级元素。

{% codepen SPxiaomin OpNmep 0 result 265 %}

## float & stacking context

浮动的内容堆叠得就好像浮动生成了新的堆叠上下文，除了定位元素和实际上生成了新的堆叠上下文的元素参与浮动的父堆叠上下文。当浮动元素和正常流(normal flow)中的其它元素重叠的时候，浮动元素会被渲染在非定位流内块(non-positioned in-flow blocks)之上，但是在流内内联(in-flow inlines)之下。

{% codepen SPxiaomin MJxazy 0 result 265 %}

## float & clear

可以使用 clear 属性来清除浮动，这样被清除浮动的盒子的 `top border edge` 会与浮动盒子的 `bottom margin edge` 对齐，这是通过在被清除浮动的盒子的 `top margin edge` 上方添加 `clearance` 来实现的。

{% codepen SPxiaomin EZMyxV 0 result 265 %}

## 浮动的应用

### 自适应布局

<!-- float & overflow: hidde | float & margin -->

## 参考

[w3c css2.1 floats](https://www.w3.org/TR/CSS2/visuren.html#floats)
